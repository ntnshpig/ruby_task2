<% content_for :content do %>

<div id="modal-window" class="modal hide fade" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content"></div>
  </div>
</div>
<h6>
  <%= link_to "Go back", user_dashboard_page_path, class: "bi bi-chevron-left link-back" %>
</h6>
<br>

<div class="row">

  <div class="col-8">
    <div class="row-width">
      <div class="row">
        <div class="col-9 mt">
          <%= @technique.title %>
        </div>
        <div class="col-3 mt-steps">
          <%= @recommendation.step-1  %> steps completed
        </div>


        <div class="col-12">
          <br>
          <div class="card">
            <div class="body_pad">
              <p class="step-title-card"><%= @step.title %></p>
              <span><%= @step.body %></span>
              <br>
            </div>
          </div>
        </div>
        <div class="col-12">
          <br>
          <div class="row">
              <div class="col-4">
                <% if @recommendation.step > 1  %>
                  <%= link_to 'RESTART', restart_path(technique_id: @recommendation.technique.id, step_id: @recommendation.step), method: :patch, class:"get_down_link"%>
                <% else %>
                  <div class="color-button-non-active">RESTART</div>
                <% end %>
              </div>
              <div class="col-4">
                Step <%= @recommendation.step %> of <%= @technique.total_steps %>
              </div>
              <div class="col-4">
                <% if @recommendation.step == @technique.total_steps %>
                  <%= link_to 'PASSED', user_rate_window_path(step_id: @step.number),  {:remote => true, 'data-bs-toggle' =>  "modal", 'data-bs-target' => '#modal-window', class: "btn btn-sing-up get_down_link"}  %>
                <% else %>
                  <%= link_to 'PASSED', user_technique_detail_path(step_id: @step.number), class:"btn btn-sing-up" %>
                <% end %>
              </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <div class="col-4">
    <div class="row-width">

      <div class="row">

        <div class="col-6 mt-s-m active-page">
          <button id="my-users">Summary</button>
        </div>
        <div class="col-6 mt-s-m">
          <button id="waiting">Message</button>
        </div>


        <div class="col-12">
          <br>
            <div class="card h-100">
              <div class="item">
                <% if @technique.photo.attached? %>
                  <img src="<%= url_for(@technique.photo) %>" class= "card-img-top" alt="...">
                <% else %>
                  <img src="<%= asset_path('anthony-tran-vXymirxr5ac-unsplash.jpg') %>" class="card-img-top" alt="...">
                <% end %>
                <% if @technique.problems %>
                  <div class="tags-div-absolute">
                    <% @technique.problems.each do |problem|%>
                      <span class="tags-in-image "><%= problem.name%></span>
                    <% end %>
                  </div>
                <% end %>

              </div>
              <div class="card-body">
                <h6 class="title_card"><%= @technique.title %></h6>

                <p class="description"><%= @technique.description %></p>
                <div class="age">Age: <strong><%= @technique.age %> years</strong></div>
                <div class="gender">Gender: <strong><%= @technique.gender %></strong></div>
                <br>
                <div class="step">Steps:<strong> <%= @technique.total_steps %></strong></div>
                <div class="duration">Duration:<strong> <%= @technique.duration %> </strong></div>
                <div class="row">
                  <div class="col-2 image-coach-techinque">
                    <% if @recommendation.coach.avatar.attached? %>
                      <img src="<%= url_for(@recommendation.coach.avatar) %>" class= "rounded-circle notification-avatar">
                    <% else %>
                      <img src="<%= asset_path('generic-user-icon-10.png') %>" class="rounded-circle notification-avatar">
                    <% end %>
                  </div>
                  <div class="col-10 name-coach-techinque">
                    <%= @recommendation.coach.name %>
                  </div>
                </div>
                <ul class="hr">
                  <li><i class="bi bi-people"></i> <%= Recommendation.where(technique_id: @recommendation.technique.id).count%></li>
                  <li><i class="bi bi-hand-thumbs-up"></i> <%= Rating.where(technique_id: @recommendation.technique.id).sum(:like)%></li>
                  <li><i class="bi bi-hand-thumbs-down"></i>  <%= Rating.where(technique_id: @recommendation.technique.id).sum(:dislike)%></li>

              </div>
            </div>

        </div>

      </div>
    </div>
  </div>
</div>
<br>



<% end %>
<%= render template: "user/show" %>
